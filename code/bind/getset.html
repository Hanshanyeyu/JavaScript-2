<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>数据双向绑定</title>
</head>
<body>
<ul>
	<li>
		<label for="name">姓名</label>
		<input id="name" name="name" type="text"/>
	</li>
	<li>
		<label for="age">年龄</label>
		<select id="age" name="age">
			<option>21</option>
			<option>22</option>
			<option>23</option>
			<option>25</option>
            <option>26</option>
            <option>27</option>
            <option>28</option>
            <option>29</option>
		</select>
	</li>
</ul>

<script>
	const VIEW = {
		nameEl: document.getElementById('name'),
		ageEl: document.getElementById('age')
	}

	function User(name, age) {
		this.name = name;
		this.age = age;
	}

    // data -> view
	Object.defineProperty(User.prototype, 'name', {
		set: function(name) {
			VIEW.nameEl.value = name;
		},
		get: function() {
			return VIEW.nameEl.value;
		}
	});

    // data -> view
	Object.defineProperty(User.prototype, 'age', {
		set: function(age) {
			var ageOptions = Array.from(VIEW.ageEl.options).map(item => item.innerHTML);
			if (ageOptions.indexOf(age) === -1) {
				// throw new Error('年龄范围：21 ~ 29');
				console.warn('年龄范围：21 ~ 29');
                return;
			}
			VIEW.ageEl.value = age;
		},
		get: function() {
			return VIEW.ageEl.value;
		}
	});

    // view -> data
    User.prototype.bind = function(VIEW) {
		VIEW.nameEl.addEventListener('change', evt => {
			this.name = evt.target.value;
            console.log(this);
		});
		VIEW.ageEl.addEventListener('change', evt => {
			this.age = evt.target.value;
            console.log(this);
		});
	}

	var user = new User('Lucy', '23');
	user.bind(VIEW);

</script>

</body>
</html>
